#!/usr/bin/env zsh
zmodload zsh/datetime

# Detect Meridiem Format String
format_meridiem="%p"

case `strftime "%P" $EPOCHSECONDS` in
	P|A)
		# GNU strftime(3)
		format_meridiem="%p"
		;;
	*)
		# BSD strftime(3)
		format_meridiem="%P"
		;;
esac

format_short="%L:%M $format_meridiem"
format_medium="%a %L:%M $format_meridiem"
format_long="%a %b %f %L:%M $format_meridiem"
format_full="%A, %B %f %G %L:%M:%S $format_meridiem"
format_iso8601="%Y-%m-%dT%H:%M:%S%z"

case $1 in
	short|s)
		format=$format_short
		;;
	medium|m)
		format=$format_medium
		;;
	long|l)
		format=$format_long
		;;
	full|f)
		format=$format_full
		;;
	8601|iso|i)
		format=$format_iso8601
		;;
	*)
		format=$1
		;;
esac

timestamp=$EPOCHSECONDS

if [ $# -gt 1 ]; then
	timestamp=$2
fi

strftime "$format" $timestamp