#!/usr/bin/env zsh
zmodload zsh/datetime

# Preset Date Formats
format_short="%L:%M %P"
format_medium="%a %L:%M %P"
format_long="%a %b %f %L:%M %P"
format_full="%A, %B %f %G %L:%M:%S %P"
format_iso8601="%Y-%m-%dT%H:%M:%S%z"

case $1 in
	short|s)
		format=$format_short
		;;
	medium|m)
		format=$format_medium
		;;
	long|l)
		format=$format_long
		;;
	full|f)
		format=$format_full
		;;
	8601|iso|i)
		format=$format_iso8601
		;;
	*)
		format=$1
		;;
esac

# Detect Meridiem Format String and override
meridiem=`strftime "%P" $EPOCHSECONDS`
meridiem=${${meridiem/P/}/A/}

if [ -z $meridiem ]; then
	# GNU strftime(3)
	format=${format/"%P"/"%p"}
fi

timestamp=$EPOCHSECONDS

if [ $# -gt 1 ]; then
	timestamp=$2
fi

strftime "$format" $timestamp